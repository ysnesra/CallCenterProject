
Call center uygulamasý .NET Core 6'da, ORM Toollarýndan EntityFramework ile Codefirst tekniði kullanýlarak geliþtirildi. 

Bu uygulama, müþteri hizmetleri temsilcilerinin müþterilerle görüþmelerini yönetmelerine olanak tanýyan bir arayüz saðlar. 
Müþteri bilgileri, talep türleri ve çözümlerle ilgili veri kaydý yapar

1.CodeFirst ORM tekniðiyle MsSQL'de database oluþturuldu -> CallCenterDb isminde 
2.EntityFramework kütüphaneleri DataAccess ve Core katmanlarýna yüklendi.
3.Core Katmanýna --> IEntity,IDto,
	                 IEntityRepository (CRUD iþlemelerinin generic olrak oluþturuldu)
					 EfEntityRepositoryBase ((TEntity,TContext) hangi tablo, hangi veritabaný verillirse ona göre CRUD iþlemlerini yapacak base sýnýfý oluþturuldu.

4. 
*.FluentValidation desteði eklendi.
	Kullanýcý adý boþ geçilemez,Password alaný en az sekiz karakter, en az bir harf ve bir sayý içermelidir... gibi kurallar verildi.
*.ActionFilter(.Net'in kendi DependencyEnjection özellliði)
*.Business-> DependencyResolvers ->DependecyEnjection.cs clasýnda "AddBusinessService" isminde extention methot oluþturuldu.Ve program.cs ye kullanaðý service "builder.Services.AddBusinessService()" eklendi.

5.Arayüzde iconlar kullanmak için -> Fontawesome kütüphanesini eklendi. 

6.Müþteri Login,Register sayfalarý yapýldý.

7.Login Ýþlemi
  *Login.chtml sayafasýndan verileri modeli doldurarak deðilde Ajax ile Json data olarak Login actionýna gönderildi.
  *Login olan kiþi database de varsa CreteToken metotuyla Jwt Token üretildi.
  *program.cs ye JwtBearer service'i eklenerek JWT authentication yapýlandýrýlmasý yapýldý.
  *Oluþan Token, Jquery Ajax kýsmýnda-> 
    "token" adlý çerez oluþturulur ve kullanýcýnýn tarayýcýsýnda cookie çerezlerine kaydedilir.
	 Böylece; Cookie Çerezdeki token sayesinde kullanýcý sonraki isteklerinde sunucu tarafýndan tanýnýr.
  *Bu token ile Authenticate ve Authorize iþlemleri yapýldý.

  Burda Authorize iþlemini Layout tarafýnda " @if (User.Identity.IsAuthenticated)" kodu sürekli false geldiði çalýþmadýðý için yöntem deðiþikliðine gidildi:
      -JWT Tokený -> Cookieye Ajax ile yüklemek yerine Controllerda CookiesAppend() metotuyla yüklendi.Buda olmayýnca; 
       Cookie Authentication yönt kullanýldý.

8.Müþteri login olduktan sonra Anasayfada neleri görecek belirlemek için;
  Layout.cshtml sayfasýna if bloðu ile kontrol edildi.

9.Customer tablosuna "Role" kolonu eklendi. Defaultu customer belirlendi.
  Layot sayfasýnda Authenticate mi eðer Authenticate olduysa Rolüne göre Anasayfada göreceði butonlar ayarlandý
  Eðer rolü customerRep ise "Müþteri Temsilcisi" butonunu görebilecek.

10.Müþteri tarafýnda(Customer);
   * Müþteri Sayfasý
   * Taleplerim Sayfasý
   * Talep Formu Sayfasý yapýldý.
   Müþteri Talep ekleyebiliyor ve Taleplerini tarih sýrasýna göre görebiliyor.

11.Müþteri Temsilcisi tarafýnda(CustomerRep);
   * Müþteri Temsilcisi Sayfasý
   * Müþteri Talepleri Sayfasý
   * Ýlgilenilen Talepler Sayfasý
   * Talep Detaylarý Sayfasý
   * Talep Görüþme Sayfasý

12.Müþteri Temsilcisi
   Müþteri Talepleri sayfasýndan "Talep Al" butonuna týklayýnca -> Talep Detaylarý sayfasý açýlýr
   Müþteri Temsilcisi talebi alýnca; Request tablsunda StatusId=2 ve CustomerRepId ye deðer atanarak güncelleme yapýldý. Artýk bu Talep, müþteri temsilcisine atandý ve durumu "talep deðerlendiriliyor"a çekildi.

13.Talep Detaylarý sayfasýndan "Talep Görüþme" butonuna týklayýnca -> Talep Görüþme sayfasý açýlýr
   Müþteri Temsilcisi görüþmenin notlarýný alýp Kaydet butonua týklayýnca ve Call tablosuna kaydedilir


   ********************************************************************************************
                                        #### Refactoring 1 ####
 Veritabaný baðlantýsýný dinamik hale getirildi.Veritabaný deðiþirse sadece ConnectionString'i deðiþtirmiþ olucaz
 
 CallCenterDbContext.cs classýnda OnConfiguring yazmak yerine appsettings.json içine ConnectionString yazýldý.
 ServiceExtentions.cs classýnda AddDbContext servisi eklendi.
 program.cs de bu ServiceExtentions class tanýtýlýken parametre de eklenir
 CallCenterDbContext.cs clasýna parametreli constructor eklendi

                                        #### Refactoring 2 ####
 AddSingleton yerine AddScoped kullanýldý.
 Her istekte iþlemler deðiþtiði, veritabaný güncelelndiði için bu yaklaþým doðru deðil.Bu yüzden AddScoped kullanýlýr.

 AddSingleton : 1 kez oluþur Ram'e kaydeder ve hep onu kullanýr.//Bütün requetlerde ayný instance'ý kullanýr 
 AddScoped    : Her istekte 1 nesne üretir.//Gelen her ayný Requestte ayný instance'ý kullanýr. 
                Farklý Requestlerde yeni bir instance oluþturup kullanýr.
 AddTransient : Her kullanýmda yeni nesne üretir.Ayný Requestte olsa yeni instance oluþturup kullanýr

                                        #### Refactoring 3 ####
 DataAccess kýsmýnda her seferinde using içinde context (veritabaný nesnesi) üretmek yerine constructor üzerinden Dependency Injection ile nesneyi ürettiriz.LooseCouple ile baðýmlýlýðýný azaltmýþ oluruz.

                                        #### Refactoring 4 ####
 Generic tarafta EfEntityRepositoryBase.cs clasýnda  .SaveChanges() metotu oluþturuldu. Böylece Add,Update gibi iþlemlerin içinde database e kaydetmek yerine bütün iþlemler bittiðinde biz istediðimizde database e kaydetmiþ oluruz.

                                        #### Refactoring 5 ####
 Müþteri Temsilcisi sayfasýna;
   Dropboxýn içine "Deðerlendirilen Talepler" ve "Yeni Talepler" seçeneðide eklendi.
   Müþteri Temsilcisinin sadece kendi çözdüðü talepleri listeleyebilmesi için "Çözdüðüm Talepler" butonu eklendi.

                                        #### Refactoring 6 ####
 Admin -> Raporlarý görecek kiþi ve MüþteriTemsilcilerini ayarlayan kiþi
 Layoutu farklý oluþturuldu -> _AdminLayout.cshtml Yönetim Paneli sayfasý yapýldý
 Admin Role olarak verildi.
 Admin Sayfasýnda;
    *Talepleri görebiliyor //Müþteri Temsilcisi kýsmýnda yaptýðým yer link olarak verildi
    *Bütün Müþterileri listeleyebiliyor.Her Müþterinin Taleplerine gidip Müþteriye ait Talepleri görebiliyor
    *Bütün Müþteri Temsilcilerini listeleyebiliyor,Ekleyebiliyor,Güncelleyebiliyor ve Silebiliyor.
    *MüþteriTemsilcisi eklerken ve Güncellerken Formu doldururken Validation kurallarý yazýldý.
        //CustomerRepRegisterValidator, CustomerRepEditValidator
    *Raporlar
       -Raporlar Sayfasý yapýldý. Müþteri Temsilcisinin ortalama kaç Talepe Cevap verdiði ve ortalama talep cevaplama süresi hesaplanýr. 
       -Tarihe göre Raporlar Sayfasý yapýldý. Belirlenen Tarih aralýðýna göre Raporlarý getirecek þekilde ayarlandý. 
        Örneðin Mayýs Ayý Raporlarýný görmek için -> baþlangýç ve bitiþ tarihini seçip Göster dediðinde filtreli olarak Raporlarý görür.
          
                                        #### Refactoring 7 ####
Müþteriler Sayfasýnda; Müþteri Profil Sayfasý yapýldý.2 farklý yol denendi.
    1."Bilgilerim" sekmesine týklayýnca -> Müþteri kendi bilgilerini model üzerinden günceller.
    2."Profilim" sekmesine týklayýnca -> Müþteri kendi bilgilerinden hangisini deðiþtirmek istiyorsa sadece onu deðiþtirir. Burada Model kullanmadan her biri için action oluþturularak yapýldý.Böylece tek bir deðiþiklik yapýldýðýnda tüm deðerler güncellenmemiþ olur. 
      Toastr.js kütüphanesi kullanýldý.Deðiþiklik yapýldýðýný müþteriye mesaj penceresi olarak bildirmemizi saðlar.
      Deðiþiklik olduðunda yada olmadýðýnda ekrana mesaj verme CustomerInformationProfile.cshtml ve CustomerController tarafýnda if ve try-catch bloklarý ile düzenlendi.

Login olurken de Mail ve Parola eþleþmezse ekrana hata mesajý veren toastr penceresi açýlcak þekilde düzenlendi.

                                        #### Refactoring 8 ####
Müþteri Temsilcisi talebi çözüp Call tablosuna kaydettiðinde -> Müþteriye otomatik olarak bilgilendirme Mailinin gitmesi 
 
1. Core -> Helpers -> EmailToInformation isminde extentions metotu oluþturuldu.
   Müþteriye gönderilecek olan bilgilendirme e-postasýnýn bir þablonunu buraya yazýldý.
2. Hotmail hesabý üzerinden mail gönderimi yapýldý.SMTP serverýnýn ismine hotmail ayarlar kýsmýndan bakýlýp yazýldý.
   username kýsmýnda hotmail adresimi, password kýsmýna da mailin þifresi yazýldý.
   alýcýmail(recipientEmail) adreside callControllerdan geliyor.Müþteriye maili send ediyor
 
